<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PRS: First part</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PRS
   </div>
   <div id="projectbrief">System programming project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('first_part_page.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">First part </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md0">Archive header</a></li>
<li class="level1"><a href="#autotoc_md1">Properties of the tiles</a><ul><li class="level2"><a href="#autotoc_md2">Path of the tiles</a></li>
<li class="level2"><a href="#autotoc_md3">Properties of the tiles</a></li>
<li class="level2"><a href="#autotoc_md4">Retrieve the properties of a specific tile</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md5">Map header</a></li>
<li class="level1"><a href="#autotoc_md6">Map data</a></li>
<li class="level1"><a href="#autotoc_md7">Detailed organization of an archive of maps</a><ul><li class="level2"><a href="#autotoc_md8">Overview of a map archive</a></li>
<li class="level2"><a href="#autotoc_md9">Relationships within a map archive</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md10">Potential improvements</a></li>
</ul>
</div>
<div class="textblock"><p>The first part of the project is dedicated to the design of an archive of maps. Although not required, an archive will allow to organize and store multiple maps in the same place. This was done in anticipation of a possible change in the specifications.</p>
<p>For now an archive of maps contains only one map. However, it can be easily extended.</p>
<p>This part of the project deals width the <a class="el" href="map_8h.html">map.h</a> header and the <a class="el" href="mapio_8c.html">mapio.c</a> source files.</p>
<p>See the <a class="el" href="group__game__group.html">game</a> module for more information.</p>
<h1><a class="anchor" id="autotoc_md0"></a>
Archive header</h1>
<p>The header of the archive is made up of a signature (see <a class="el" href="maputil_8h.html#ad4e1298eefe90362ff9a7959d47368b3">MARC_HEADER</a>), the number of tiles used by the maps, the offset of the properties of the tiles used and the offset of the first map.</p>
<p>Each of these information is defined on <code>4</code> bytes.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Properties of the tiles</h1>
<p>A tile is represented by six properties:</p>
<ul>
<li>A path to an image containing the tile or a tileset;</li>
<li>The number of frames of the tile;</li>
<li>The solidity property of the tile (can it be crossed);</li>
<li>The destructible property of the tile (can it be destroyed);</li>
<li>The collectible property of the tile (can it be collected);</li>
<li>The generator property of the tile (does it trigger an action).</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Path of the tiles</h2>
<p>The path of each tile is represented on <code>64</code> bytes.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Properties of the tiles</h2>
<p>First of all, the properties of each tile is preceded by a signature (see <a class="el" href="maputil_8h.html#abc4719b3905c3987b77d342388d4c067">OBJECT_PROPERTIES_HEADER</a>). Then, the number of frames of the tile, the solidity property of the tile, the destructible property of the tile, the collectible property of the tile and the generator property of the tile follow.</p>
<p>Each of these infomation is defined on <code>4</code> bytes. For each tile, a padding of <code>8</code> bytes is added.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Retrieve the properties of a specific tile</h2>
<p>The order of declaration of the properties of the tiles is the same as the order of declaration of the paths of the tiles. Both information depends on the number of tiles declared in the archive header.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Map header</h1>
<p>The header of a map is made up of a signature (see <a class="el" href="maputil_8h.html#a3c101d9aa6408825a83cdcce1d9de925">MAPF_HEADER</a>), the width of the map, the height of the map and the size of the map.</p>
<p>Each of these information is represented on <code>4</code> bytes.</p>
<p>Note that the width and the height of the map are represented in terms of number of tiles.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Map data</h1>
<p>The data of the map are represented on <code>1</code> byte and correspond to the indices of the tile.</p>
<p>As mentionned above, the index of a tile corresponds to its order of appearance in the section related to the declaration of the paths of the tiles.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Detailed organization of an archive of maps</h1>
<h2><a class="anchor" id="autotoc_md8"></a>
Overview of a map archive</h2>
<div class="image">
<object type="image/svg+xml" data="maparchive1.svg" style="pointer-events: none;"></object>
<div class="caption">
Archive of maps</div></div>
   <h2><a class="anchor" id="autotoc_md9"></a>
Relationships within a map archive</h2>
<div class="image">
<object type="image/svg+xml" data="maparchive2.svg" style="pointer-events: none;"></object>
<div class="caption">
Archive of maps</div></div>
   <h1><a class="anchor" id="autotoc_md10"></a>
Potential improvements</h1>
<p>Here are some potential improvements:</p>
<ul>
<li>Use a buffer in order to limit the invokation of the <a href="https://man7.org/linux/man-pages/man2/read.2.html">read</a> and <a href="https://man7.org/linux/man-pages/man2/write.2.html">write</a> system calls;</li>
<li>Extend the map archives so that they contain multiple maps (the <code>libgame.a</code> static library must be disassembled).</li>
<li>Extend the map archives so that they contain multiple directories (possible by using a k-ary tree). </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="project_page.html">Project</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
